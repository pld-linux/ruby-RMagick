diff --git a/ext/RMagick/extconf.rb b/ext/RMagick/extconf.rb
index 6446d40..78a6260 100644
--- a/ext/RMagick/extconf.rb
+++ b/ext/RMagick/extconf.rb
@@ -233,6 +233,7 @@ have_func("snprintf", headers)
    "LevelColorsImageChannel",        # 6.5.6-4
    "LevelizeImageChannel",           # 6.4.2
    "LiquidRescaleImage",             # 6.3.8-2
+   "MagickLibAddendum",              # 6.5.9-1
    "OpaquePaintImageChannel",        # 6.3.7-10
    "QueueAuthenticPixels",           # 6.4.5-6
    "RemapImage",                     # 6.4.4-0
diff --git a/ext/RMagick/rmagick.h b/ext/RMagick/rmagick.h
index e18a678..8aa6f3f 100644
--- a/ext/RMagick/rmagick.h
+++ b/ext/RMagick/rmagick.h
@@ -162,6 +162,13 @@
 #define DestroyConstitute(void) ConstituteComponentTerminus(void)
 #endif
 
+/** ImageMagick 6.5.9 replaced MagickLibSubversion with
+ * MagickLibAddendum.
+ */
+#if defined(HAVE_MAGICKLIBADDENDUM)
+#define MagickLibSubversion MagickLibAddendum
+#endif
+
 /** IM 6.4.1 replaced AllocateImage with AcquireImage.
  * Both have the same signature.
  */
--- RMagick-2.13.0/ext/RMagick/rmimage.c~	2009-12-21 11:34:57.000000000 +0100
+++ RMagick-2.13.0/ext/RMagick/rmimage.c	2010-03-03 13:58:39.770186927 +0100
@@ -9815,7 +9815,7 @@
 #else
             IndexPacket *indexes = GetIndexes(image);
 #endif
-            old_color = image->colormap[*indexes];
+            old_color = image->colormap[(unsigned long)*indexes];
         }
         if (!image->matte)
         {
--- RMagick-2.13.0/ext/RMagick/extconf.rb~	2009-12-24 07:03:02.000000000 +0100
+++ RMagick-2.13.0/ext/RMagick/extconf.rb	2010-03-03 14:00:35.276124598 +0100
@@ -151,15 +151,6 @@
 
   $magick_version = `Magick-config --version`.chomp
 
-  # Ensure ImageMagick is not configured for HDRI
-  unless checking_for("HDRI disabled version of ImageMagick") do
-    not (`Magick-config --version`["HDRI"])
-  end
-    exit_failure "\nCan't install RMagick #{RMAGICK_VERS}."+
-           "\nRMagick does not work when ImageMagick is configured for High Dynamic Range Images."+
-           "\nDon't use the --enable-hdri option when configuring ImageMagick.\n"
-  end
-
   # Save flags
   $CFLAGS     = ENV["CFLAGS"].to_s   + " " + `Magick-config --cflags`.chomp
   $CPPFLAGS   = ENV["CPPFLAGS"].to_s + " " + `Magick-config --cppflags`.chomp
